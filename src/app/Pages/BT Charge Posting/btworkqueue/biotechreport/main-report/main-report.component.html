<kendo-grid class="w-100" [data]="mainGridData" [hideHeader]="true">
  <ng-template kendoGridToolbarTemplate>
    <button class="pull-right mr-1" type="button" kendoGridExcelCommand>
      Export to Excel
    </button>
    <button class="pull-right mr-1" type="button" kendoGridPDFCommand>
      Export to pdf
    </button>
  </ng-template>
  <kendo-grid-column>
    <ng-template kendoGridCellTemplate let-dataItem>
      <div class="row" id="mainReportId">
        <ng-container *ngIf="dataItem.folderAccessionsCountGridData">
          <div
            class="col-md-12"
            *ngFor="let item of dataItem.folderAccessionsCountGridData"
          >
            <div class="card">
              <div class="card-header pl-2 border-0">
                <h5 class="mb-0">
                  <span class="mr-3">Date: {{ item.date }}</span
                  ><span> Julian Date: {{ item.juliandate }}</span>
                </h5>
              </div>
              <!-- <kendo-grid class="w-100" [data]="folderAccessionsCountGridView">
              <kendo-grid-column
                width="20"
                field="folder"
                title="Folder"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate>Total</ng-template>
              </kendo-grid-column>
              <kendo-grid-column
                width="20"
                field="docsvaultfilecount"
                title="DocsVault File Count"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate let-column>
                  {{ sumDocumentCount(column.field) }}
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column
                width="30"
                field="uniqueaccession"
                title="Unique Accession#"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate let-column>
                  {{ sumDocumentCount(column.field) }}
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column
                width="30"
                field="coversheetcount"
                title="Cover-sheet Count"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate let-column>
                  0
                </ng-template>
              </kendo-grid-column>
              <kendo-grid-column
                width="30"
                field="qonductorordercount"
                title="Qonductor Order Count"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate let-column>
                  {{ sumDocumentCount(column.field) }}
                </ng-template>
              </kendo-grid-column>
            </kendo-grid> -->
              <table>
                <thead>
                  <tr>
                    <th>Folder</th>
                    <th>DocsVault File Count</th>
                    <th>Unique Accession#</th>
                    <th>Cover-sheet Count</th>
                    <th>Qonductor Order Count</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let ele of item.folderAccessionsCountData">
                    <td>{{ ele.folder }}</td>
                    <td>{{ ele.docsvaultfilecount }}</td>
                    <td>{{ ele.uniqueaccession }}</td>
                    <td>{{ ele.coversheetcount }}</td>
                    <td>{{ ele.qonductorordercount }}</td>
                  </tr>
                  <tr>
                    <td><b>Total</b></td>
                    <td>
                      <b>
                        {{
                          getSumByFieldName(
                            item.folderAccessionsCountData,
                            "docsvaultfilecount"
                          )
                        }}</b
                      >
                    </td>
                    <td>
                      <b>
                        {{
                          getSumByFieldName(
                            item.folderAccessionsCountData,
                            "uniqueaccession"
                          )
                        }}</b
                      >
                    </td>
                    <td>
                      <b>
                        {{
                          getSumByFieldName(
                            item.folderAccessionsCountData,
                            "coversheetcount"
                          )
                        }}</b
                      >
                    </td>
                    <td>
                      <b>
                        {{
                          getSumByFieldName(
                            item.folderAccessionsCountData,
                            "qonductorordercount"
                          )
                        }}</b
                      >
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </ng-container>
        <!-- <div class="col-md-12">
          <div class="card">
            <div class="card-header pl-2 border-0">
              <h5 class="mb-0">Qonductor Order by Category</h5>
            </div>
            <kendo-grid class="w-100" [data]="">
              <kendo-grid-column
                width="20"
                field="category"
                title="Category"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate>Total</ng-template>
              </kendo-grid-column>
              <kendo-grid-column
                width="20"
                field="count"
                title="Count"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
                <ng-template kendoGridFooterTemplate let-column> </ng-template>
              </kendo-grid-column>
            </kendo-grid>
          </div>
        </div> -->
        <ng-container *ngIf="dataItem.orderByCategoryGridData">
          <div class="card">
            <div class="card-header pl-3 border-0">
              <h5 class="mb-0">Qonductor Order by Category</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div
                  class="col-md-4"
                  *ngFor="let item of dataItem.orderByCategoryGridData"
                >
                  <div class="card-header pl-2 border-0">
                    <h5 class="mb-0">{{ item.folder }}</h5>
                  </div>
                  <table>
                    <thead>
                      <tr>
                        <th>Category</th>
                        <th>Count</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let ele of item.orderByCategoryData">
                        <td>{{ ele.category }}</td>
                        <td>{{ ele.count }}</td>
                      </tr>
                      <tr>
                        <td><b>Total</b></td>
                        <td>
                          <b>{{
                            getSumByFieldName(item.orderByCategoryData, "count")
                          }}</b>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </ng-container>
        <div class="col-md-12" *ngIf="dataItem.hl7DftsGridData">
          <div class="card">
            <div class="card-header pl-2 border-0">
              <h5 class="mb-0">HL7 DFT's</h5>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Category</th>
                  <th>Count</th>
                  <th>Comments</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let item of dataItem.hl7DftsGridData">
                  <td>{{ item.category }}</td>
                  <td>{{ item.count }}</td>
                  <td>{{ item.comments }}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <!-- <div class="col-md-12">
          <div class="card">
            <div class="card-header pl-2 border-0">
              <h5 class="mb-0">HL7 DFT's</h5>
            </div>
            <kendo-grid class="w-100" [data]="">
              <kendo-grid-column
                width="20"
                field="category"
                title="Category"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
              </kendo-grid-column>
              <kendo-grid-column
                width="20"
                field="count"
                title="Count"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
              </kendo-grid-column>
              <kendo-grid-column
                width="20"
                field="comments"
                title="Comments"
                [headerStyle]="{ 'font-weight': 'bold' }"
                [headerClass]="'text-center'"
                [footerClass]="'text-center'"
                [class]="'text-center'"
              >
              </kendo-grid-column>
            </kendo-grid>
          </div>
        </div> -->
      </div>
    </ng-template>
  </kendo-grid-column>
  <kendo-grid-excel fileName="Products.xlsx"></kendo-grid-excel>
  <kendo-grid-pdf fileName="Products.pdf"> </kendo-grid-pdf>
</kendo-grid>
